name: Gold Eye AI

on:
  schedule:
    - cron: '*/30 * * * *'  # æ¯30åˆ†é’Ÿè¿è¡Œ
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    # ğŸ”¥ å…³é”®æƒé™ï¼šå…è®¸æœºå™¨äººä¿®æ”¹ä»£ç åº“
    permissions:
      contents: write
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
      
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'
        
    - name: Install dependencies
      run: pip install requests feedparser
      
    - name: Run Gold Eye & Record Stats
      env: 
        PUSH_TOKEN: ${{ secrets.PUSH_TOKEN }}
        DEEPSEEK_KEY: ${{ secrets.DEEPSEEK_KEY }}
      run: python main.py
      
    # ğŸ”¥ æ ¸å¿ƒé»‘ç§‘æŠ€ï¼šæŠŠæ–°è´¦æœ¬â€œè‡ªåŠ¨æäº¤â€å› GitHub
    - name: Commit and Push Ledger
      run: |
        git config --global user.name "GoldEyeBot"
        git config --global user.email "bot@goldeye.ai"
        git add trade_history.json
        # åªæœ‰å½“æ–‡ä»¶æœ‰å˜åŒ–æ—¶æ‰æäº¤ï¼Œé˜²æ­¢æŠ¥é”™
        git commit -m "ğŸ“ˆ Update trade ledger [skip ci]" || echo "No changes to commit"
        git push
